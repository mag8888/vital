# üíæ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## ‚úÖ –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:

1. **–°–∫—Ä–∏–ø—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è**: `scripts/backup-database-railway.js`
2. **API endpoint**: `POST /admin/backup` –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫**: –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 02:00 UTC (05:00 –ú–°–ö)
4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Cloudinary**: –ë—ç–∫–∞–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ Cloudinary

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ Railway:

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Railway Dashboard ‚Üí Variables —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

```env
# Cloudinary (–¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±—ç–∫–∞–ø–æ–≤)
CLOUDINARY_CLOUD_NAME=dt4r1tigf
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL=your_mongodb_connection_string

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø
ENABLE_AUTO_BACKUP=true  # –∏–ª–∏ false –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ Railway:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø** –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 02:00 UTC
2. **–†—É—á–Ω–æ–π –±—ç–∫–∞–ø** –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É:
   - –û—Ç–∫—Ä–æ–π—Ç–µ `/admin`
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Å–µ–∫—Ü–∏—é "üì¶ –ö–æ–Ω—Ç–µ–Ω—Ç"
   - –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üíæ –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –ë–î"

### 3. –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –±—ç–∫–∞–ø—ã

- **Cloudinary**: `plazma-bot/backups/` (–æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
- **–õ–æ–∫–∞–ª—å–Ω–æ –Ω–∞ Railway**: `/tmp/` (–≤—Ä–µ–º–µ–Ω–Ω–æ, —É–¥–∞–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Cloudinary)

## üìã –§–æ—Ä–º–∞—Ç –±—ç–∫–∞–ø–∞

–ë—ç–∫–∞–ø —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –∏ –≤–∫–ª—é—á–∞–µ—Ç:

- ‚úÖ –í—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –í—Å–µ —Ç–æ–≤–∞—Ä—ã –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –í—Å–µ –∑–∞–∫–∞–∑—ã
- ‚úÖ –í—Å–µ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –ø—Ä–æ—Ñ–∏–ª–∏ –∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã
- ‚úÖ –í—Å–µ –æ—Ç–∑—ã–≤—ã
- ‚úÖ –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏
- ‚úÖ –í—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã
- ‚úÖ –í–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –±–æ—Ç–∞
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—é –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤

## üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞

–î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `scripts/import-database.js` (–µ—Å–ª–∏ —Å–æ–∑–¥–∞–Ω) –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Prisma.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `src/server.ts`:

```typescript
// –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 02:00 UTC (05:00 –ú–°–ö)
cron.schedule('0 2 * * *', async () => {
  // ...
}, { timezone: 'UTC' });
```

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [cron —Å–∏–Ω—Ç–∞–∫—Å–∏—Å](https://crontab.guru/).

## üö® –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ Railway –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±—ç–∫–∞–ø–æ–≤:

```bash
# –í Railway Dashboard ‚Üí Deployments ‚Üí View Logs
# –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
# - "üîÑ –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è..."
# - "‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –∑–∞–≤–µ—Ä—à–µ–Ω:"
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—ç–∫–∞–ø–∞

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –±—ç–∫–∞–ø–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –ø–æ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü–µ
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
- URL –≤ Cloudinary (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ë—ç–∫–∞–ø—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º
- –§–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º Cloudinary –∞–∫–∫–∞—É–Ω—Ç–µ
- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏

## üõ†Ô∏è –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

### –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É:
1. –û—Ç–∫—Ä–æ–π—Ç–µ `/admin`
2. –ù–∞–∂–º–∏—Ç–µ "üíæ –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –ë–î"

### –ß–µ—Ä–µ–∑ API:
```bash
curl -X POST https://plazma-production.up.railway.app/admin/backup \
  -H "Cookie: connect.sid=your_session_cookie"
```

### –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç:
```bash
npm run backup
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ë—ç–∫–∞–ø—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –†–∞–∑–º–µ—Ä –±—ç–∫–∞–ø–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö (–æ–±—ã—á–Ω–æ 2-10 MB)
- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –±—ç–∫–∞–ø–∞: 10-30 —Å–µ–∫—É–Ω–¥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
- –°—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã –≤ Cloudinary –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—É–¥–∞–ª—è–π—Ç–µ –≤—Ä—É—á–Ω—É—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

