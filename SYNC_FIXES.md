# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –±–∞–ª–∞–Ω—Å–∞ –∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üîß –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **–£–±—Ä–∞–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚úÖ
**–§–∞–π–ª:** `src/services/partner-service.ts:268-272`

**–ë—ã–ª–æ:**
```typescript
// –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–ª–æ user.balance –Ω–∞ —Å—É–º–º—É —Ç–æ–ª—å–∫–æ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏—Ö –±–æ–Ω—É—Å–æ–≤
await prisma.user.update({
  where: { id: updatedProfile.userId },
  data: { balance: totalBonus }  // ‚ùå –ü–ï–†–ï–ó–ê–ü–ò–°–´–í–ê–ï–¢!
});
```

**–°—Ç–∞–ª–æ:**
```typescript
// –ù–ï –æ–±–Ω–æ–≤–ª—è–µ–º user.balance - –æ–Ω —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ increment/decrement
// partnerProfile.balance —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ
```

### 2. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** ‚úÖ
**–§–∞–π–ª:** `src/services/partner-service.ts:recordPartnerTransaction`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ CREDIT —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ - —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º `user.balance` —á–µ—Ä–µ–∑ `increment`
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ DEBIT —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ - —É–º–µ–Ω—å—à–∞–µ–º `user.balance` —á–µ—Ä–µ–∑ `decrement`
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –±–∞–ª–∞–Ω—Å–∞

### 3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è 3 PZ –∑–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–∞** ‚úÖ
**–§–∞–π–ª:** `src/modules/navigation/index.ts:520-590`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –ï—Å–ª–∏ –µ—Å—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å - –Ω–∞—á–∏—Å–ª—è–µ–º —á–µ—Ä–µ–∑ `recordPartnerTransaction` (–∫–æ—Ç–æ—Ä—ã–π —Å–∞–º —É–≤–µ–ª–∏—á–∏—Ç –±–∞–ª–∞–Ω—Å)
- –ï—Å–ª–∏ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è - –Ω–∞—á–∏—Å–ª—è–µ–º –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ –±–∞–ª–∞–Ω—Å
- –£–±—Ä–∞–Ω–æ –¥–≤–æ–π–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ

## üìä –¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ –±–∞–ª–∞–Ω—Å–∞

### `user.balance` - –û–±—â–∏–π –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏: –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –±–æ–Ω—É—Å—ã, –ø–æ–∫—É–ø–∫–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ (`/api/user/profile`)
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `increment`/`decrement`, –ù–ï –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è

### `partnerProfile.balance` - –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å
- –¢–æ–ª—å–∫–æ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –±–æ–Ω—É—Å—ã (—Å—É–º–º–∞ –≤—Å–µ—Ö PartnerTransaction)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –±–æ—Ç–µ (–ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–π –¥–∞—à–±–æ—Ä–¥) –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ (`/api/partner/dashboard`)
- –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —á–µ—Ä–µ–∑ `recalculatePartnerBonuses`

## ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –±–æ—Ç–æ–º –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### –ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ë–æ—Ç:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è `user.balance` (–æ–±—â–∏–π –±–∞–ª–∞–Ω—Å)
- **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è `user.balance` (–æ–±—â–∏–π –±–∞–ª–∞–Ω—Å)
- ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω**

### –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å
- **–ë–æ—Ç:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è `partnerProfile.balance` (—Ç–æ–ª—å–∫–æ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –±–æ–Ω—É—Å—ã)
- **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è `partnerProfile.balance` (—Ç–æ–ª—å–∫–æ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –±–æ–Ω—É—Å—ã)
- ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω**

### –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
- **–ë–æ—Ç:** `https://t.me/Vital_shop_bot?start=username`
- **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** `https://t.me/Vital_shop_bot?start=username`
- ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω**

## üéØ –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ 3 PZ –∑–∞ –Ω–æ–≤–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ `https://t.me/Vital_shop_bot?start=username`
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –Ω–æ–≤—ã–π –ª–∏ —ç—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
3. –ï—Å–ª–∏ –Ω–æ–≤—ã–π –∏ —Ä–µ—Ñ–µ—Ä–µ—Ä –Ω–∞–π–¥–µ–Ω:
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ (–µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ—Ñ–∏–ª—å)
   - –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è 3 PZ –Ω–∞ –±–∞–ª–∞–Ω—Å —Ä–µ—Ñ–µ—Ä–µ—Ä–∞
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ–º

**–í–∞–∂–Ω–æ:**
- ‚úÖ –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞ –ù–û–í–´–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ù–µ –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ
- ‚úÖ –ë–∞–ª–∞–Ω—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. `user.balance` –∏ `partnerProfile.balance` - —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
   - `user.balance` - –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å (–≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏)
   - `partnerProfile.balance` - —Ç–æ–ª—å–∫–æ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –±–æ–Ω—É—Å—ã

2. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `increment`/`decrement`

3. –§—É–Ω–∫—Ü–∏—è `recalculatePartnerBonuses` –±–æ–ª—å—à–µ –ù–ï –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç `user.balance`, —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç `partnerProfile.balance`





