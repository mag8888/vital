# 🏗️ ДИАГРАММА АРХИТЕКТУРЫ ПРОЕКТА EM1

## 📊 ТЕКУЩАЯ АРХИТЕКТУРА

```
┌─────────────────────────────────────────────────────────────────┐
│                        EM1 PROJECT                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐                    │
│  │   VERSION 1.0   │    │   VERSION 2.0   │                    │
│  │   (LEGACY)      │    │   (CURRENT)     │                    │
│  └─────────────────┘    └─────────────────┘                    │
│           │                       │                            │
│           ▼                       ▼                            │
│  ┌─────────────────┐    ┌─────────────────┐                    │
│  │   assets/js/    │    │  game-board/    │                    │
│  │                 │    │                 │                    │
│  │ ┌─────────────┐ │    │ ┌─────────────┐ │                    │
│  │ │    CORE     │ │    │ │   SERVICE    │ │                    │
│  │ │             │ │    │ │             │ │                    │
│  │ │ GameCore    │ │    │ │GameBoardSvc │ │                    │
│  │ │ ModuleMgr   │ │    │ │GameBoardUI  │ │                    │
│  │ │ PlayerMgr   │ │    │ │GameBoardMgr │ │                    │
│  │ │ StateMgr    │ │    │ │             │ │                    │
│  │ └─────────────┘ │    │ └─────────────┘ │                    │
│  │                 │    │                 │                    │
│  │ ┌─────────────┐ │    │ ┌─────────────┐ │                    │
│  │ │   MODULES   │ │    │ │    DATA     │ │                    │
│  │ │             │ │    │ │             │ │                    │
│  │ │ BankModule  │ │    │ │professions  │ │                    │
│  │ │ CardModule  │ │    │ │   data.js   │ │                    │
│  │ │ DiceModule  │ │    │ │             │ │                    │
│  │ │ EventModule │ │    │ └─────────────┘ │                    │
│  │ │ MovementMod │ │    │                 │                    │
│  │ └─────────────┘ │    │ ┌─────────────┐ │                    │
│  │                 │    │ │   SERVER    │ │                    │
│  │ ┌─────────────┐ │    │ │             │ │                    │
│  │ │  SERVICES   │ │    │ │  Express    │ │                    │
│  │ │             │ │    │ │  Static     │ │                    │
│  │ │ ApiService  │ │    │ │  Files      │ │                    │
│  │ │ EventBus    │ │    │ │             │ │                    │
│  │ │ StorageSvc  │ │    │ └─────────────┘ │                    │
│  │ └─────────────┘ │    │                 │                    │
│  │                 │    │ ┌─────────────┐ │                    │
│  │ ┌─────────────┐ │    │ │    PAGES    │ │                    │
│  │ │     UI      │ │    │ │             │ │                    │
│  │ │             │ │    │ │  auth.html  │ │                    │
│  │ │ Board.js    │ │    │ │ lobby.html  │ │                    │
│  │ │ Notifications│ │    │ │ game.html   │ │                    │
│  │ └─────────────┘ │    │ │ index.html  │ │                    │
│  └─────────────────┘    │ └─────────────┘ │                    │
│                         └─────────────────┘                    │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                    EXTERNAL SERVICES                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐                    │
│  │   RAILWAY       │    │   TELEGRAM      │                    │
│  │   DEPLOYMENT    │    │      BOT        │                    │
│  │                 │    │                 │                    │
│  │ • Production    │    │ • Bot Logic     │                    │
│  │ • Staging       │    │ • Handlers      │                    │
│  │ • Database      │    │ • Keyboards     │                    │
│  └─────────────────┘    └─────────────────┘                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 🔄 ПОТОК ДАННЫХ

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   CLIENT    │    │   SERVER    │    │  DATABASE   │
│             │    │             │    │             │
│ 1. Request  │───▶│ 2. Process  │───▶│ 3. Store    │
│             │    │             │    │             │
│ 4. Response │◀───│ 5. Send     │◀───│ 6. Retrieve │
└─────────────┘    └─────────────┘    └─────────────┘
```

## 🎯 ПРОБЛЕМЫ АРХИТЕКТУРЫ

### ❌ ДУБЛИРОВАНИЕ
```
GameCore.js ←→ GameBoardService.js
Board.js ←→ GameBoardUI.js
ModuleManager.js ←→ GameBoardManager.js
```

### ❌ КОНФЛИКТ ЗАВИСИМОСТЕЙ
```
/package.json (MongoDB, JWT, bcrypt)
/game-board/package.json (Express only)
```

### ❌ МНОЖЕСТВЕННЫЕ СЕРВЕРЫ
```
/server.js (Main)
/game-board/server.js (Static)
/minimal-server.js (Test)
```

## ✅ РЕКОМЕНДУЕМАЯ АРХИТЕКТУРА

```
┌─────────────────────────────────────────────────────────────────┐
│                    UNIFIED ARCHITECTURE                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                FRONTEND LAYER                           │   │
│  │                                                         │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │    AUTH     │  │    LOBBY    │  │    GAME     │    │   │
│  │  │   Page      │  │    Page     │  │    Page     │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                BUSINESS LAYER                           │   │
│  │                                                         │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │   SERVICE   │  │     UI      │  │  MANAGER    │    │   │
│  │  │   Layer     │  │   Layer     │  │   Layer     │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                DATA LAYER                               │   │
│  │                                                         │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │  PROFESSIONS│  │    CARDS    │  │   CONFIG    │    │   │
│  │  │    DATA     │  │    DATA     │  │    DATA     │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                INFRASTRUCTURE                           │   │
│  │                                                         │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │   EXPRESS   │  │   RAILWAY   │  │  TELEGRAM   │    │   │
│  │  │   SERVER    │  │  DEPLOYMENT │  │     BOT     │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 🎯 ПЛАН МИГРАЦИИ

### Фаза 1: Очистка
1. Удалить дублирующие файлы
2. Объединить package.json
3. Создать единую точку входа

### Фаза 2: Унификация
1. Мигрировать функциональность v1.0 в v2.0
2. Унифицировать API
3. Обновить документацию

### Фаза 3: Оптимизация
1. Добавить тестирование
2. Оптимизировать производительность
3. Улучшить UX



























